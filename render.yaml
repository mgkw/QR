# Ø¥Ø¹Ø¯Ø§Ø¯Ø§Øª Render.com Ø§Ù„Ù…Ø­Ø³Ù†Ø© Ù„Ù‚Ø§Ø±Ø¦ Ø§Ù„Ø¨Ø§Ø±ÙƒÙˆØ¯
services:
  # Web Service (Node.js Application)
  - type: web
    name: qr-scanner-nodejs-enhanced
    runtime: node
    plan: free
    region: oregon
    buildCommand: |
      npm install --production=false &&
      npm run migrate
    startCommand: npm run start:enhanced
    envVars:
      - key: NODE_ENV
        value: production
      - key: PORT
        value: 10000
      - key: TZ
        value: Asia/Baghdad
    healthCheckPath: /api/health
    healthCheckInterval: 60000
    healthCheckTimeout: 30000
    numInstances: 1
    
    # Ø¯Ø¹Ù… Ø§Ù„Ù…Ù„ÙØ§Øª Ø§Ù„Ø«Ø§Ø¨ØªØ©
    staticPublishPath: ./public
    
    # Ø¥Ø¹Ø¯Ø§Ø¯Ø§Øª Ø¥Ø¶Ø§ÙÙŠØ©
    preDeployCommand: echo "ØªØ­Ø¶ÙŠØ± Ø§Ù„Ù†Ø´Ø±..."
    
# Build settings Ø§Ù„Ù…Ø­Ø³Ù†Ø©
buildCommand: |
  echo "ğŸš€ Ø¨Ø¯Ø¡ Ø¹Ù…Ù„ÙŠØ© Ø§Ù„Ø¨Ù†Ø§Ø¡..." &&
  npm ci --production=false &&
  echo "ğŸ”§ ØªÙ‡ÙŠØ¦Ø© Ù‚Ø§Ø¹Ø¯Ø© Ø§Ù„Ø¨ÙŠØ§Ù†Ø§Øª..." &&
  npm run migrate &&
  echo "âœ… ØªÙ… Ø§Ù„Ø¨Ù†Ø§Ø¡ Ø¨Ù†Ø¬Ø§Ø­"

startCommand: npm run start:enhanced

# Auto-deploy settings
autoDeploy: true

# Environment variables
envVars:
  - name: NODE_ENV
    value: production
  - name: PORT
    value: 10000
  - name: TZ
    value: Asia/Baghdad
  - name: DATABASE_PATH
    value: /tmp/database.db
  
# Health check Ù…Ø­Ø³Ù†
healthCheckPath: /api/health
healthCheckInterval: 60000
healthCheckTimeout: 30000
healthCheckRetries: 3

# Resources Ù…Ø­Ø³Ù†Ø©
plan: free
memory: 512MB
cpu: 0.5

# Disk settings
disk: 
  size: 1GB
  mount: /tmp

# Custom headers for security
headers:
  - path: /*
    headers:
      X-Frame-Options: DENY
      X-Content-Type-Options: nosniff
      X-XSS-Protection: "1; mode=block"
      Referrer-Policy: strict-origin-when-cross-origin

# Routes Ù„Ù„ØµÙØ­Ø§Øª Ø§Ù„Ù…Ø®ØªÙ„ÙØ©
routes:
  - type: rewrite
    source: /simple
    destination: /public/index.html
  - type: rewrite
    source: /api/*
    destination: /api/*
  - type: rewrite
    source: /*
    destination: /index.html 