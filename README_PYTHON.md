# 🚀 قارئ الباركود المتطور - نسخة Python

## 📋 نظرة عامة

تطبيق ويب متطور لقراءة الباركود والـ QR Code باستخدام **Python Flask** و **SQLite** كقاعدة بيانات محلية. يوفر واجهة عربية حديثة مع إمكانيات متقدمة للمسح والحفظ والإرسال للتليجرام.

## ✨ الميزات الرئيسية

### 🔍 مسح الباركود
- **مسح مستمر**: المسح التلقائي بدون توقف
- **أنواع متعددة**: دعم جميع أنواع الباركود والـ QR
- **قراءة شاملة**: نصوص وأرقام ورموز خاصة
- **منع التكرار**: تجنب مسح نفس الكود مرارًا

### 🗄️ قاعدة البيانات
- **SQLite محلية**: لا تحتاج اتصال إنترنت
- **حفظ فوري**: تخزين تلقائي لكل نتيجة مسح
- **بحث متقدم**: إمكانية البحث في النتائج
- **تصدير البيانات**: JSON و CSV

### 📊 الإحصائيات والتقارير
- **لوحة تحكم تفاعلية**: مخططات ورسوم بيانية
- **إحصائيات فورية**: عداد المسح اليومي والإجمالي
- **تحليل البيانات**: أكثر الأكواد مسحًا
- **تتبع الأداء**: معدل النجاح والإرسال

### 💬 تكامل تليجرام
- **إرسال فوري**: إشعارات لحظية للتليجرام
- **تنسيق غني**: رسائل HTML مع تفاصيل كاملة
- **اختبار الاتصال**: التحقق من صحة الإعدادات
- **حالة الإرسال**: تتبع نجاح/فشل الإرسال

## 🛠️ التثبيت والتشغيل

### المتطلبات الأساسية
```bash
Python 3.8+
pip (مدير الحزم)
```

### خطوات التثبيت

1. **تحميل المشروع**
```bash
git clone <repository-url>
cd QR-main
```

2. **تثبيت التبعيات**
```bash
pip install -r requirements.txt
```

3. **تشغيل التطبيق**
```bash
python app.py
```

4. **فتح التطبيق**
- الرابط: http://localhost:5000
- لوحة التحكم: http://localhost:5000/dashboard  
- الإعدادات: http://localhost:5000/settings

## 📱 كيفية الاستخدام

### 1. الإعداد الأولي
- افتح صفحة الإعدادات
- أدخل رمز البوت من @BotFather
- أضف معرف المحادثة
- اختبر الاتصال

### 2. المسح
- اضغط "بدء المسح"
- وجه الكاميرا للباركود
- سيتم الحفظ والإرسال تلقائيًا

### 3. المراقبة
- تابع الإحصائيات في الصفحة الرئيسية
- استخدم لوحة التحكم للتحليل المفصل
- صدر البيانات عند الحاجة

## 🔧 الإعدادات المتقدمة

### إعدادات المسح
- **المسح المستمر**: تفعيل/إلغاء المسح التلقائي
- **الصوت**: تشغيل صوت التنبيه
- **تأخير منع التكرار**: المدة بين المسحات (1-10 ثواني)

### إعدادات التطبيق
- **عنوان التطبيق**: تخصيص العنوان
- **لون السمة**: اختيار اللون المفضل
- **النسخ الاحتياطي**: تصدير جميع البيانات

## 🗂️ هيكل المشروع

```
QR-main/
├── app.py                  # التطبيق الرئيسي
├── requirements.txt        # التبعيات
├── qr_scanner.db          # قاعدة البيانات (تُنشأ تلقائيًا)
├── templates/             # صفحات HTML
│   ├── index.html         # الصفحة الرئيسية
│   ├── dashboard.html     # لوحة التحكم
│   └── settings.html      # صفحة الإعدادات
└── uploads/               # مجلد الصور (يُنشأ تلقائيًا)
```

## 📊 قاعدة البيانات

### جدول النتائج (scan_results)
```sql
- id: الرقم التسلسلي
- code_data: بيانات الباركود
- code_type: نوع الباركود  
- timestamp: وقت المسح
- user_agent: معلومات المتصفح
- ip_address: عنوان IP
- notes: ملاحظات
- telegram_sent: حالة الإرسال للتليجرام
- image_path: مسار الصورة
```

### جدول الإعدادات (settings)
```sql
- id: الرقم التسلسلي
- key: مفتاح الإعداد
- value: قيمة الإعداد
- updated_at: تاريخ التحديث
```

## 🔗 واجهة برمجة التطبيقات (API)

### نقاط النهاية الرئيسية
- `POST /api/scan` - حفظ نتيجة مسح جديدة
- `GET /api/results` - الحصول على النتائج مع تصفح وبحث
- `GET /api/statistics` - إحصائيات شاملة
- `GET/POST /api/settings` - إدارة الإعدادات
- `GET /api/export` - تصدير البيانات

### مثال على حفظ نتيجة مسح
```javascript
fetch('/api/scan', {
    method: 'POST',
    headers: { 'Content-Type': 'application/json' },
    body: JSON.stringify({
        code_data: "123456789",
        code_type: "CODE_128",
        notes: "ملاحظات إضافية"
    })
})
```

## 🔧 استكشاف الأخطاء

### مشاكل شائعة وحلولها

#### 1. خطأ في تشغيل التطبيق
```bash
# تأكد من تثبيت التبعيات
pip install -r requirements.txt

# تحقق من إصدار Python
python --version  # يجب أن يكون 3.8+
```

#### 2. مشاكل الكاميرا
- تأكد من السماح للمتصفح بالوصول للكاميرا
- استخدم HTTPS للمواقع الخارجية
- جرب متصفح مختلف

#### 3. مشاكل تليجرام
- تحقق من صحة رمز البوت
- تأكد من إضافة البوت للمجموعة
- اختبر الاتصال من صفحة الإعدادات

#### 4. مشاكل قاعدة البيانات
```bash
# إذا تلفت قاعدة البيانات، احذفها وأعد التشغيل
rm qr_scanner.db
python app.py
```

## 🔒 الأمان

### ممارسات الأمان المطبقة
- **تشفير الاتصال**: HTTPS للإنتاج
- **التحقق من المدخلات**: تنظيف جميع البيانات المدخلة
- **منع SQL Injection**: استخدام Prepared Statements
- **تحديد الصلاحيات**: عدم السماح بعمليات خطيرة

### نصائح الأمان
- غيّر `SECRET_KEY` في الإنتاج
- استخدم HTTPS دائماً
- أنشئ نسخ احتياطية دورية
- قم بتحديث التبعيات بانتظام

## 📈 تحسينات الأداء

### نصائح التحسين
- **استخدم SQLite WAL Mode** للأداء الأفضل
- **ضع حد للنتائج** في الاستعلامات
- **فعّل الـ Gzip** في الخادم
- **استخدم CDN** للموارد الثابتة

## 🚀 النشر

### النشر المحلي
```bash
python app.py
# التطبيق سيعمل على http://localhost:5000
```

### النشر على خادم
```bash
# استخدم gunicorn للإنتاج
pip install gunicorn
gunicorn -w 4 -b 0.0.0.0:5000 app:app
```

### النشر على Docker
```dockerfile
FROM python:3.9-slim
WORKDIR /app
COPY requirements.txt .
RUN pip install -r requirements.txt
COPY . .
EXPOSE 5000
CMD ["python", "app.py"]
```

## 🤝 المساهمة

مرحب بالمساهمات! يرجى:
1. إنشاء Fork للمشروع
2. إنشاء branch للميزة الجديدة
3. تطبيق التغييرات مع الاختبارات
4. إرسال Pull Request

## 📞 الدعم

للحصول على المساعدة:
- فتح Issue في GitHub
- مراسلة المطور
- مراجعة الوثائق

## 📄 الترخيص

هذا المشروع مرخص تحت [MIT License](LICENSE)

## 🔄 سجل التغييرات

### الإصدار 2.0.0 (الحالي)
- ✅ إعادة كتابة كاملة بـ Python + SQLite
- ✅ واجهة عربية محدثة ومحسّنة
- ✅ لوحة تحكم تفاعلية مع مخططات
- ✅ نظام إعدادات متقدم
- ✅ تكامل محسّن مع تليجرام
- ✅ دعم تصدير البيانات
- ✅ مسح مستمر محسّن
- ✅ إحصائيات تفصيلية

### الإصدار 1.0.0 (Firebase)
- قاعدة بيانات Firebase
- واجهة JavaScript بسيطة
- وظائف مسح أساسية

---

**🎉 استمتع باستخدام قارئ الباركود المتطور!** 