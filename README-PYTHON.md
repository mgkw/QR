# 🐍 قارئ الباركود - Python Version

## نظام شامل لمسح الباركود مع قاعدة بيانات SQLite

### 🚀 المميزات
- **قراءة متقدمة**: دعم QR Codes والباركود التقليدي
- **قاعدة بيانات SQLite**: سريعة وموثوقة
- **نظام مستخدمين**: تسجيل دخول مع صلاحيات متعددة
- **إشعارات التليجرام**: إرسال تلقائي للمسحات
- **إحصائيات شاملة**: تقارير مفصلة ورسوم بيانية
- **كشف التكرار**: منع المسح المتكرر خلال 20 ثانية
- **واجهة عربية**: دعم كامل للغة العربية

---

## 📋 المتطلبات

### البرمجيات المطلوبة:
- **Python 3.8+** 
- **pip** (مدير الحزم)
- **متصفح حديث** يدعم الكاميرا

### المكتبات Python:
```
Flask==3.0.0           # إطار العمل الرئيسي
Flask-CORS==4.0.0      # دعم CORS
Werkzeug==3.0.1        # أدوات Flask
pytz==2023.3           # التوقيت الزمني
requests==2.31.0       # طلبات HTTP
```

---

## 🛠️ التثبيت والتشغيل

### 1. التشغيل السريع (مستحسن):
```bash
python start.py
```
هذا الأمر سيقوم بـ:
- ✅ التحقق من متطلبات Python
- 📦 تثبيت المكتبات المطلوبة
- 🗄️ إنشاء قاعدة البيانات
- 🚀 بدء الخادم

### 2. التثبيت اليدوي:
```bash
# تثبيت المتطلبات
pip install -r requirements.txt

# تشغيل التطبيق
python app.py
```

---

## 🌐 الوصول للتطبيق

### محلياً:
- **الكمبيوتر**: http://localhost:5000
- **الشبكة المحلية**: http://[عنوان_IP]:5000

### العثور على عنوان IP:
```bash
# Windows
ipconfig

# Mac/Linux  
ifconfig
```

---

## 👥 المستخدمون الافتراضيون

### الأونر (المدير):
- **اسم المستخدم**: `admin`
- **كلمة المرور**: `owner123`
- **الصلاحيات**: إدارة كاملة

### مستخدم تجريبي:
- **اسم المستخدم**: `test`
- **كلمة المرور**: لا توجد
- **الصلاحيات**: مسح الباركود فقط

---

## 🗂️ هيكل المشروع

```
QR-main/
├── app.py                 # التطبيق الرئيسي
├── start.py              # script التشغيل
├── requirements.txt      # متطلبات Python
├── Procfile             # للنشر على Heroku
├── qr_scanner.db        # قاعدة بيانات SQLite
├── app.log             # ملف السجلات
├── index.html          # الواجهة الأمامية
├── script.js           # JavaScript الرئيسي
├── library-loader.js   # تحميل المكتبات
└── styles.css          # التصميم
```

---

## 📊 قاعدة البيانات

### الجداول:
1. **users**: بيانات المستخدمين
2. **scans**: المسحات المحفوظة
3. **settings**: إعدادات التطبيق
4. **user_sessions**: جلسات المستخدمين

### عرض قاعدة البيانات:
```bash
# تثبيت أداة SQLite (اختياري)
pip install sqlite-web

# عرض قاعدة البيانات في المتصفح
sqlite-web qr_scanner.db
```

---

## 🔧 الإعدادات

### إعدادات التليجرام:
1. **إنشاء بوت**: @BotFather في التليجرام
2. **الحصول على Chat ID**: @userinfobot
3. **حفظ الإعدادات**: من لوحة الأونر

### إعدادات متقدمة في app.py:
```python
# منطقة التوقيت
BAGHDAD_TZ = pytz.timezone('Asia/Baghdad')

# مدة كشف التكرار (ثانية)
DUPLICATE_DETECTION_SECONDS = 20

# إعدادات Flask
app.config['SECRET_KEY'] = 'your-secret-key'
```

---

## 🛡️ الأمان

### حماية قاعدة البيانات:
- استخدام **Parameterized Queries** لمنع SQL Injection
- **تشفير كلمات المرور** بـ Werkzeug
- **جلسات آمنة** مع انتهاء صلاحية

### صلاحيات المستخدمين:
- **@authenticate_user**: للمسارات العامة
- **@authenticate_owner**: لمسارات الأونر فقط

---

## 📡 API Endpoints

### المصادقة:
```
POST /api/login           # تسجيل الدخول
POST /api/logout          # تسجيل الخروج  
POST /api/verify-session  # التحقق من الجلسة
```

### المستخدمين (أونر فقط):
```
GET    /api/users         # قائمة المستخدمين
POST   /api/users         # إضافة مستخدم
DELETE /api/users/:name   # حذف مستخدم
```

### المسحات:
```
GET  /api/scans          # جلب المسحات
POST /api/scans          # حفظ مسحة جديدة
```

### الإعدادات (أونر فقط):
```
GET  /api/settings       # جلب الإعدادات
POST /api/settings       # حفظ الإعدادات
```

---

## 🐛 استكشاف الأخطاء

### مشاكل شائعة:

#### 1. خطأ في استيراد Flask:
```bash
pip install --upgrade Flask
```

#### 2. مشكلة في الكاميرا:
- تأكد من أن المتصفح يدعم الكاميرا
- امنح الإذن للوصول للكاميرا
- استخدم HTTPS للمواقع الخارجية

#### 3. خطأ في قاعدة البيانات:
```bash
# حذف قاعدة البيانات وإعادة إنشائها
rm qr_scanner.db
python app.py
```

#### 4. فحص السجلات:
```bash
tail -f app.log
```

### رسائل السجلات:
- ✅ **INFO**: عمليات عادية
- ⚠️ **WARNING**: تحذيرات
- ❌ **ERROR**: أخطاء

---

## 🚀 النشر

### Heroku:
```bash
git init
git add .
git commit -m "Initial commit"
heroku create your-app-name
git push heroku main
```

### Railway:
```bash
railway login
railway init
railway up
```

### PythonAnywhere:
1. رفع الملفات
2. إنشاء Web App جديد
3. تحديد app.py كـ WSGI file

---

## 🔄 المقارنة مع Node.js Version

| الميزة | Python Version | Node.js Version |
|--------|---------------|-----------------|
| **قاعدة البيانات** | SQLite محلي | Turso Cloud |
| **الأداء** | ممتاز محلياً | ممتاز سحابياً |
| **التثبيت** | أبسط | أعقد |
| **التطوير** | سهل التعديل | احترافي أكثر |
| **النشر** | محلي/بسيط | سحابي/متقدم |

---

## 🤝 المساهمة

### تطوير المشروع:
1. **Fork** المشروع
2. إنشاء **branch** جديد
3. تطبيق التغييرات
4. إرسال **Pull Request**

### هيكل الكود:
- **app.py**: Backend وAPI
- **script.js**: Frontend وتفاعل المستخدم
- **styles.css**: التصميم والمظهر

---

## 📞 الدعم

### في حالة وجود مشاكل:
1. تحقق من **app.log** للأخطاء
2. تأكد من **متطلبات Python**
3. اختبر في **متصفح مختلف**
4. تأكد من **إعدادات الكاميرا**

### تقارير الأخطاء:
أرفق المعلومات التالية:
- إصدار Python
- نظام التشغيل  
- رسائل الخطأ من Console
- خطوات إعادة إنتاج المشكلة

---

## 📝 الرخصة

هذا المشروع مفتوح المصدر ومتاح للاستخدام والتطوير.

---

## 🎯 الخطط المستقبلية

- [ ] دعم قواعد بيانات أخرى (PostgreSQL, MySQL)
- [ ] API موثق بـ Swagger
- [ ] نظام النسخ الاحتياطي التلقائي
- [ ] تطبيق موبايل منفصل
- [ ] دعم المزيد من أنواع الباركود
- [ ] نظام التقارير المتقدم

---

**🚀 جاهز للاستخدام! ابدأ بتشغيل `python start.py`** 